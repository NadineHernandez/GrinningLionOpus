<!DOCTYPE html>

<html lang="en-us">

<head>

  <meta charset="UTF-8">
  <title>Found Pets</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/css/style.css">

</head>

<body>

        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-dark nav-styled">
                <a class="navbar-brand" href="#">Found Pets</a>
                
              
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                  <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                      <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="found-form.html">Found</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="lost-form.html">Lost</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="search.html">Search</a>
                    </li>
                  </ul>
                </div>
              </nav>
    
        <!-- jumbotron -->
        <div class="jumbotron jumbotron-fluid jumbo-bg-img">
                <div class="container">
            <h1 class="text-center title">Found Pets</h1>
            <p class="text-center top-text">The most important family reunion.</p>
            <p class="text-center top-text">Find lost pets. Report found pets.</p>
            <div class="top-spacer"></div>
            <p class="text-center">
                <a class="btn btn-lg teal-button" href="data.html" role="button">Data</a>
            </p>
            <p class="text-center top-text" style="margin-bottom: .5rem">Where are pets lost and found?</p>
            </div>
        </div>

        <div class="main">

        <div class="container container-fluid">
            <div class="card">
                <div class="card-header card-head-styled">
                    Search Pets
                </div>
                <div class="card-body">
                        <form>
                                <!-- User can select pet as a lost animal or a found animal -->
                                <div class="form-group">
                                    <label for="statusSelection">Lost or Found</label>
                                        <select class="form-control" id="selectStatus">
                                            <option>-Select-</option>
                                            <option value = "1">Lost</option>
                                            <option value = "2">Found</option>
                                        </select>
                                </div>

                                <!-- assuming we are limiting species to cat or dog -->
                                <div class="form-group">
                                    <label for="speciesSelection">Species</label>
                                        <select class="form-control" id="selectSpecies">
                                            <option>-Select-</option>
                                            <option value = "1">Cat</option>
                                            <option value = "2">Dog</option>
                                        </select>
                                </div>

                                <!-- user can search with one or many coat colors 
                                <div class="form-group">
                                    <div><label for="coatColor">Coat Color</label></div>

                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="brown" value="option1">
                                    <label class="form-check-label" for="color">brown</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="black" value="option2">
                                    <label class="form-check-label" for="color">black</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="white" value="option3">
                                    <label class="form-check-label" for="color">white</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="yellow" value="option4">
                                    <label class="form-check-label" for="color">yellow</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="orange" value="option5">
                                    <label class="form-check-label" for="color">orange</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="gray" value="option6">
                                    <label class="form-check-label" for="color">gray</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="checkbox" id="other" value="option7">
                                    <label class="form-check-label" for="color">other</label>
                                </div>
                                </div>-->

                                <div class="form-group">
                                    <div><label for="coatColor">Coat Color(s)</label></div>
                                        <select class="custom-select" id="coat-color" multiple>
                                            <option value="brown">Brown</option>
                                            <option value="black">Black</option>
                                            <option value="white">White</option>
                                            <option value="yellow">Yellow</option>
                                            <option value="orange">Orange</option>
                                            <option value="Gray">Gray</option>
                                            <option value="Other">Other</option>
                                        </select>
                                </div>

                                <!-- location is searched by zip code to give a general area -->
                                <div class="form-group">
                                        <div><label for="lastSeenGroup">Last Seen Near or</label><button type="image-submit" class="btn form-button">Use my Location</button>
                                        <div class="form-row">
                                        
                                        <div class="form-group col-md-2">
                                          <label for="inputZip">Zip</label>
                                          <input type="text" class="form-control" id="inputZip">
                                        </div>
                                      </div>
                                      
                                <button type="submit" class="btn teal-button" id="submit-btn">Submit</button>
                              </form>
                </div>
            </div>
            </div>
            </div>


            <!-- this area can be hidden until results are created or shown at all times -->
            <div class="card card-centered">
                <div class="card-header card-head-styled">
                    Search Results
                </div>
                <div class="card-body">
                    <!-- this is an example of what a listed result will look like when written to the DOM -->
                   <div class="card card-centered">
                        <div class="card-body">

                            <div class="row">

                            <div class="col-lg-4">
                                <img src="https://s3.amazonaws.com/cdn-origin-etr.akc.org/wp-content/uploads/2017/11/13001000/Beagle-On-White-01-400x267.jpg">
                            </div>

                            <div class="col-lg-4">
                                <p class="pet-title">Lost/Found Dog/Cat</p>
                                <div class="pet-result-info"><p>Info Dump Here</p></div>
                            </div>

                            <!-- We can have a small map area here with a marker on the location of last seen -->
                            <div class="col-lg-4">
                                <span>map here</span>
                            </div>

                            </div>

                        </div>
                   </div>
                </div>
            </div>
                
        </div>
        </div>

        <!-- footer -->
        <div class="footer navbar-fixed-bottom my-footer">
            <span><p class="text-center footer-text">Place sticky footer content here.</p></span>
        </div>
            

    


        <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
        <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
        <script type="text/javascript">
            
        config = {
        apiKey: "AIzaSyDcy6KUvKqXpNWI65gnl57TF-pQL57FlWs",
        authDomain: "pet-finder-8e4bf.firebaseapp.com",
        databaseURL: "https://pet-finder-8e4bf.firebaseio.com",
        projectId: "pet-finder-8e4bf",
        storageBucket: "pet-finder-8e4bf.appspot.com",
        messagingSenderId: "67912018638"
        };
        firebase.initializeApp(config);

        var database = firebase.database();
        
        //website reads database when laded, and sets the relevent fields as variables. This is done to solve scope issues
        //that happened when it was put inside the .on(click) event

        database.ref().on("child_added", function (childSnapshot) {

            firstName = childSnapshot.val().storedFirstName;
            lastName = childSnapshot.val().storedLastName;
            email = childSnapshot.val().storedEmail;
            petName = childSnapshot.val().storedPetName;
            species = childSnapshot.val().storedSpecies;
            imageURL = childSnapshot.val().storedImageURL;
            coatColors = childSnapshot.val().storedCoatColors;
            latitude = childSnapshot.val().storedLatitude;
            longitude = childSnapshot.val().storedLongitude;
            address = childSnapshot.val().storedAddress;
            addressTwo = childSnapshot.val().storedAddressTwo;
            city = childSnapshot.val().storedCity;
            state = childSnapshot.val().storedState;
            zip = childSnapshot.val().storedZip;
            comments = childSnapshot.val().storedComments;

            //creates an array bin for data
            var accountsArray = [];
                    //accountsArray.push

            console.log("~~~~~~~~~Account Information Relavent to Search~~~~~~~~~");
            //put childSnapshot data into array
            //for (var i=0; i < 1; i++) {
            accountsArray.push(firstName + " " + lastName, species, zip, coatColors);
            //}
                    //var coatColorArr = new Array(coatColors) 
                    //var speciesArr = new Array(species) 
                    //var zipArr = new Array(zip)

                    //$("#coat-color option:selected").each(function () {
                        //petColor.push(this.value);
                    //});
                    
                    //var i
                    //for (i = 0; i < accountArray.length; i++) {
                        //accountsArray.push(vvvvvvvvvvvvvvvvvvvvvvvvi)
                        //console.log(i)

                        //console.log(database.ref("pet-finder-8e4bf").storedFirstName)
            
            //for some reason, coatColors is returning the results of the newest entry, and the previous entry. 
            //This accumulates to all into the last entry.
            console.log("Name "+ firstName + " " + lastName);
            var coatArr = [];
            coatArr.push(coatColors);
            for (i = 0; i < coatArr.length; i++) {
                (console.log("Coat Colors: " + coatArr[i])) 
                //coatColors = undefined
            };
            console.log("Species: " + accountsArray[1]);
            console.log("Zip: " + accountsArray[2]);
            console.log("Search info in Array ["  + accountsArray +"]");

            
        
    // get the options for Lost/Found, species, and make an array for the colors
    
        $("#submit-btn").on("click", function (event) {
            //console.clear()

                //console.log("snapshot", firstName)
                // Handle errors


                event.preventDefault();
                //variables to store values
                var petStatus = ""
                var petSpecies = ""
                //Lost Or Found Input Value
                var lostOrFound = $("#selectStatus option:selected").val();
                if (lostOrFound === "1") {
                    petStatus = "Lost"
                } else {
                    petStatus = "Found"
                };
                //Cat Or Dog Input Value
                var catOrDog = $("#selectSpecies option:selected").val();
                if (catOrDog === "1") {
                    petSpecies = "Cat"
                } else {
                    petSpecies = "Dog"
                };
                //Pet Color Input Value
                var petColor = []
                $("#coat-color option:selected").each(function () {
                    petColor.push(this.value)
                })
                //Zip Input Value
                var inputZip = $("#inputZip").val();

                //Temporary/Local Storage of Data
                var newSearch = {
                    status: petStatus,
                    species: petSpecies,
                    color: petColor,
                    tempZip: inputZip,
                }
                
                //this if.statement should match the newSearch and the accountArray. 
                //If an Account Matches, it will appear in the console.log
                //I think there might be something wrong with the form? I had to delete some
                //of the color entries from firebase but it may have messed with the value
                //of the array

                if (newSearch.species === accountsArray[1] 
                //&& newSearch.color === coatArr 
                ){
                    console.log("[~~Match!~~]");
                    console.log("Name: " + accountsArray[0]);
                    console.log("Species: " + newSearch.species);
                    console.log("Color: " + coatArr);
                    console.log("Status: " + newSearch.status);
                    console.log("Zip: " + newSearch.tempZip);

                
                //console.log("~~~~~~~Search Match~~~~~~~ = True!");;
                }
                //else {console.log("[xNo_Matchx]")
                    //};

                
                
                //coatColors = undefined
            });

                //grab data from firebase
                //database.ref().on("child_added", function (childSnapshot) {
                
                    //firstName = childSnapshot.val().storedFirstName;
                    //lastName = childSnapshot.val().storedLastName;
                    //email = childSnapshot.val().storedEmail;
                    //petName = childSnapshot.val().storedPetName;
                    //species = childSnapshot.val().storedSpecies;
                    //imageURL = childSnapshot.val().storedImageURL;
                    //coatColors = childSnapshot.val().storedCoatColors;
                    //latitude = childSnapshot.val().storedLatitude;
                    //longitude = childSnapshot.val().storedLongitude;
                    //address = childSnapshot.val().storedAddress;
                    //addressTwo = childSnapshot.val().storedAddressTwo;
                    //city = childSnapshot.val().storedCity;
                    //state = childSnapshot.val().storedState;
                    //zip = childSnapshot.val().storedZip;
                    //comments = childSnapshot.val().storedComments;
                    
                //trying to pull firebase data (coatColors, species, zip)
                //so I can create a loop to compare to user data above
                //accountsArray is storing data from
                
                    //var accountsArray = [];
                    //accountsArray.push

                    //console.log("~~~~~~~~~Account Information Relavent to Search~~~~~~~~~")
                    //for (var i=0; i < 1; i++) {
                        //accountsArray.push(firstName + " " + lastName, coatColors, species, zip)
                    //}
                    //var coatColorArr = new Array(coatColors) 
                    //var speciesArr = new Array(species) 
                    //var zipArr = new Array(zip)

                    //$("#coat-color option:selected").each(function () {
                        //petColor.push(this.value);
                    //});
                    
                    //var i
                    //for (i = 0; i < accountArray.length; i++) {
                        //accountsArray.push(vvvvvvvvvvvvvvvvvvvvvvvvi)
                        //console.log(i)

                        //console.log(database.ref("pet-finder-8e4bf").storedFirstName)
                    //console.log("~~" + firstName + " " + lastName + "~~");
                    //console.log("Coat Colors: " + coatColors);
                    //console.log("Species: " + species);
                    //console.log("Zip: " + zip)
                    //console.log("Search info in Array ["  + accountsArray +"]")
                });
                //console.log("{(*=====END=====*)}")
                //console.log(accountsArray)
                    
            
            //});
            
            //console.log("test " + firstName);
            //database.ref().once("value"), function(childSnapshot) {
                // This is a snapshot of all records
                //var allRecords = childSnapshot.val();
                //console.log("submit snapshot", allRecords);
            //var i;
            
            //});
            
            //var arrRecords = [];
            //var keys = Object.keys(allRecords);
            //keys.forEach(function(key) {
                //var record = allRecords[key];
                //arrRecords.push(record);
            //});

            //var filtered = arrRecords.filter(function (record) {
                //return (
                   // record.name === newSearch.status,
                   // record.color === newSearch.petSpecies,
                //);
            //});
        //displayFilteredResults(filtered);
        //});
        
    


        //database.ref().on("child_added", function(childSnapshot) {

        </script>
</body>

</html>